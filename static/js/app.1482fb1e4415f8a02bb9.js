webpackJsonp([4],{"/eR5":function(e,n,t){"use strict";function o(e){function n(){return i}function o(n){var t=r(e,n);return i.push(t),t}e.inputs=t.i(a.a)();var i=[];return function(){var e=c.a.getQS().get("i0");if(e){var n=o(0);n.link=e,n.updateBinding(!0)}}(),{getInputs:n,addInput:o}}function r(e,n){function o(e){a&&(clearTimeout(a),a=null),e?r():a=setTimeout(r,300)}function r(){u.error=null,a=null;var o=t.i(i.a)(e,u.link,{done:function(){c.a.getQS().set("i"+n,u.link)},error:function(e){u.error=e}});e.inputs.bindInput(0,o)}var a=null,u={link:"",error:null,name:"input"+n,updateBinding:o};return u}n.a=o;var a=t("n67P"),i=(t("p2DF"),t("I6d+")),c=t("NEgR")},"2PgA":function(e,n,t){function o(e,n){function t(){var e=Object.create(null),n=window.location.search;n&&(e=Object.assign(e,a.parse(n.substr(1))));var t=window.location.hash;t&&(e=Object.assign(e,a.parse(t.substr(2)))),o(e)}function o(e){var n=v+a.stringify(e);window.history?window.history.replaceState(void 0,void 0,n):window.location.replace(n)}function i(e){if("function"!=typeof e)throw new Error("changeCallback needs to be a function");0===f.length&&window.addEventListener("hashchange",u,!1),f.push(e)}function c(){0!==f.length&&(f=[],window.removeEventListener("hashchange",u,!1))}function u(){s(d())}function s(e){for(var n=0;n<f.length;++n){(0,f[n])(e)}}function d(){var e=l?window.location.search:window.location.hash,n=(e||v).substr(v.length);return a.parse(n)}if("undefined"==typeof window)return r(e);var f=[],l=n&&n.useSearch,v=l?"?":"#?";return n.rewriteHashToSearch&&t(),function(){var n=d(),t=!1;"object"==typeof e&&e&&Object.keys(e).forEach(function(o){o in n||(n[o]=e[o],t=!0)}),t&&o(n)}(),{onChanged:i,dispose:c,set:o,get:d,rewriteHashToSearch:t}}e.exports=o;var r=t("5hi0"),a=t("9XuS")},"3xg8":function(e,n,t){"use strict";function o(e){function n(n){p.setCustomVectorField(n);var t=p.getFragmentShader(),o=p.getVertexShader(),r=a.a.createProgram(_,o,t);h&&h.unload(),h=r,e.colorMode===c.a.VELOCITY&&w.requestSpeedUpdate()}function o(n,o){m=e.particleStateResolution;var r=[{name:"x",particleState:n},{name:"y",particleState:o}];y&&y.dispose(),y=t.i(s.a)(_,r,m),g&&g.dispose(),g=t.i(s.a)(_,r,m),w.updateParticlesCount()}function i(n){e.colorMode===c.a.VELOCITY&&w.setColorMinMax(n),y.bindTextures(_,n)}function f(){var n=h;_.useProgram(n.program),a.a.bindAttribute(_,e.quadBuffer,n.a_pos,2),e.inputs.updateBindings(n),e.audioTexture&&(a.a.bindTexture(_,e.audioTexture,5),_.uniform1i(n.u_audio,5)),y.bindTextures(_,n),_.uniform1f(n.u_rand_seed,e.frameSeed),_.uniform1f(n.u_h,e.integrationTimeStep),_.uniform1f(n.frame,e.frame);var t=e.cursor;_.uniform4f(n.cursor,t.clickX,t.clickY,t.hoverX,t.hoverY);var o=e.bbox;_.uniform2f(n.u_min,o.minX,o.minY),_.uniform2f(n.u_max,o.maxX,o.maxY),_.uniform1f(n.u_drop_rate,e.dropProbability);for(var r=0;r<g.length;++r){var i=g.get(r);_.uniform1i(n.u_out_coordinate,r),a.a.bindFramebuffer(_,e.framebuffer,i.texture),_.viewport(0,0,m,m),_.drawArrays(_.TRIANGLES,0,6)}e.colorMode===c.a.VELOCITY&&w.updateParticlesPositions(n),b&&(x(n),b=null);var u=y;y=g,g=u}function l(e){b=e}function x(n){var o=[{name:"x",particleState:b.x},{name:"y",particleState:b.y}],i=b.resolution,c=i*i,u=t.i(s.a)(_,o,i),f=t.i(s.a)(_,o,i);u.bindTextures(_,n);var l=f.get(0);_.uniform1i(n.u_out_coordinate,6),a.a.bindFramebuffer(_,e.framebuffer,l.texture),_.viewport(0,0,i,i),_.drawArrays(_.TRIANGLES,0,6);var p=new Uint8Array(4*c);_.readPixels(0,0,i,i,_.RGBA,_.UNSIGNED_BYTE,p),_.uniform1i(n.u_out_coordinate,7),l=f.get(1),a.a.bindFramebuffer(_,e.framebuffer,l.texture),_.viewport(0,0,i,i),_.drawArrays(_.TRIANGLES,0,6);var x=new Uint8Array(4*c);_.readPixels(0,0,i,i,_.RGBA,_.UNSIGNED_BYTE,x),f.dispose(),u.dispose();for(var y=t.i(d.a)(),g=t.i(d.a)(),m=new Float32Array(c),h=new Float32Array(c),w=0;w<x.length;w+=4){var E=w/4,T=r(p,w),P=r(x,w);m[E]=T,h[E]=P,y.add(T),g.add(P)}var M={xStats:y,yStats:g,decoded_velocity_x:m,decoded_velocity_y:h,resolution:i};v.a.fire("vector-line-ready",M)}var y,g,m,h,b,_=e.gl,w=t.i(u.a)(e);return v.a.on("vector-lines-request",l),{updateCode:n,updateParticlesPositions:f,updateParticlesCount:o,prepareToDraw:i}}function r(e,n){return t.i(f.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=o;var a=t("Ddjs"),i=t("Qv35"),c=t("6c6E"),u=t("gIFv"),s=t("pXNl"),d=t("V39N"),f=t("FaU1"),l=t("eBcr"),v=t.n(l),p=new i.a},"4KA4":function(e,n,t){"use strict";var o=t("Zrlr"),r=t.n(o),a=t("wxAW"),i=t.n(a),c=function(){function e(){r()(this,e)}return i()(e,[{key:"getDefines",value:function(){return""}},{key:"getFunctions",value:function(){return""}},{key:"getMainBody",value:function(){return""}}]),e}();n.a=c},"5hi0":function(e,n){function t(e){function n(){return c}function t(e){c=e,setTimeout(function(){a(e)},0)}function o(){i=[]}function r(e){if("function"!=typeof e)throw new Error("changeCallback should be a function");i.push(e)}function a(e){i.forEach(function(n){n(e)})}var i=[],c=e;return{dispose:o,onChanged:r,set:t,get:n}}e.exports=t},"6c6E":function(e,n,t){"use strict";n.a={UNIFORM:1,VELOCITY:2,ANGLE:3,CUSTOM:4}},"7QEO":function(e,n,t){"use strict";n.a=[{name:"Secret door",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.15344999999999986,cy:-.1291,w:7.4611,h:7.4611,code:"// p.x and p.y are current coordinates\n  // v.x and v.y is a velocity at point p\n  vec2 get_velocity(vec2 p) {\n    vec2 v = vec2(0., 0.);\n\n    // change this to get a new vector field\n    v.x = p.y*p.y ;\n    v.y = -p.x*p.x *.05;\n\n    return v;\n  }"},{name:"Miserables graph with edges",timeStep:-.001,fadeOut:.998,dropProbability:.008,colorMode:2,cx:.467,cy:1.5294,w:.9368,h:.9368,showBindings:1,i0:"https://gist.githubusercontent.com/anvaka/ebc18e3ffe05b0709a7ae933261fa2e9/raw/bafb63d01e0ab37c1f9b51522a5ec4fbc19bc4f1/edges.png",code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec4 c = texture2D(input0, vec2(mod(p.x,1.), 1. - mod(p.y, 1.)));\n  v.x = (c.r + c.g/255.) - 0.5;\n  v.y = 0.5 - (c.b + c.a/255.);\n\n  if (length(v) < 0.1) v = vec2(0.);\n  return (v);\n}",particleCount:4e4},{name:"Roads",timeStep:.001,fadeOut:.998,dropProbability:.009,colorMode:2,cx:.478,cy:.2636,w:.9922,h:.9922,showBindings:0,i0:"https://gist.githubusercontent.com/anvaka/ebc18e3ffe05b0709a7ae933261fa2e9/raw/cd7d82c5a235f50f5655ac94aa9077709731adde/binary_tree.png",code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec4 c = texture2D(input0, vec2(mod(p.x,1.), 1. - mod(p.y, 1.)));\n  v.x = (c.r + c.g/255.) - 0.5;\n  v.y = 0.5 - (c.b + c.a/255.);\n\n  return (v);\n}",particleCount:4e4},{name:"Four counterclockwise cogs pushing particles clockwise :)",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.7887499999999994,cy:-.5769500000000001,w:16.3759,h:16.3759,code:"vec2 field(vec2 p) {\n  float d = length(p);\n  return vec2(-p.y, p.x) * exp(-d*d*0.1);\n}\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v = field(p + vec2(-5., 0.)) +\n    field(p + vec2(-2.5, 2.5)) +\n    field(p + vec2(0., 0.)) +\n    field(p + vec2(-2.5, -2.5));\n  return v;\n}"},{name:"Waveshaping [interactive]",cx:0,cy:-.060899999999999954,w:12,h:12,timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,code:"float f(float x) {\n  bool supportsHover = length(cursor.zw) > 0.01;\n  vec2 c = supportsHover ? cursor.zw : cursor.xy;\n  float f1 = sin(x);\n  float f2 = sin(2.*x);\n  float f3 = sin(3.*x);\n  float f4 = sin(4.*x);\n  float f5 = sin(5.*x);\n  return f1 +\n    f2*c.x/4. +\n    f3*c.y/6. +\n    f4*c.x/8. +\n    f5*c.y/10.;\n}\n\nfloat df(float x) {\n  float h = 0.001;\n  return (f(x+h)-f(x-h))/(2.*h);\n}\n\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  float fx = f(p.x);\n  float d = abs(p.y-fx);\n  float dfx = df(p.x);\n  vec2 toOrigin = -p/(20.*length(p));\n  vec2 toF = 0.1*vec2(0.,fx-p.y);\n  v = d < 0.1 ? vec2(1.,dfx) : toF;\n  return v;\n}",particleCount:5e4},{name:"Hex plane [interactive]",timeStep:.01,fadeOut:.99,dropProbability:.99,colorMode:3,cx:0,cy:0,w:8.5398,h:8.5398,code:"vec2 nearest(vec2 p) {\n// Charles Chambers black hex magic\nfloat temp = floor(p.x + sqrt(3.) * p.y + 1.);\nfloat q = floor((floor(2.*p.x+1.) + temp) / 3.);\nfloat r = floor((temp + floor(-p.x + sqrt(3.) * p.y + 1.))/3.);\nreturn vec2(q-p.y/2.,r-p.y/8.);\n}\n\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  float f = frame/1000.;\n  float z = (3.-p.y)/(6.+cursor.zw.y*2.);\n  float a = cursor.zw.x;\n  vec2 r = vec2(cos(a)*p.x - sin(a)*p.y,sin(a)*p.x+cos(a)*p.y);\n  vec2 t = vec2(r.x / z, r.y / z);\n  vec2 n = nearest(t);\n  v.x = t.x-n.x;\n  v.y = t.y-n.y;\n  return v;\n}",particleCount:5e5},{name:"Rain",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"bool isUnshadowed(vec2 p) {\n  bool upper = length(p) > 1.0 && p.y > 0.0;\n  bool lower = length(p) > 1.0 && p.y < 0.0 && abs(p.x) > 1.0;\n  return upper || lower;\n}\n\nvec2 unshadowedV(vec2 p) {\n  return vec2(0.0,-3.0+p.y);\n}\n\nbool isSpray(vec2 p) {\n  return length(p) > 1.0 && abs(p.x) < 1.0;\n}\n\nvec2 sprayV(vec2 p) {\n  float vy = -1.0+p.y;\n  float vx = p.x > 0.0 ? (1.0-p.x)/vy : (-1.0-p.x)/vy;\n  return vec2(vx,vy);\n}\n\nbool isCircle(vec2 p) {\n  return length(p) > 1.0 && length(p) < 1.05;\n}\n\nvec2 circleV(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  v.x = sign(p.x)* p.y;\n  v.y = -abs(p.x);\n  return v;\n}\n\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  v = isCircle(p) ? circleV(p) :\n      isUnshadowed(p) ? unshadowedV(p) :\n      isSpray(p) ? sprayV(p) : vec2(1.0/0.0,1.0/0.0);\n\n  return v;\n}",particleCount:1e4},{name:"Mouse-driven Julia Set",timeStep:.01,fadeOut:.9,dropProbability:.009,colorMode:3,cx:-.27144999999999997,cy:.14175000000000004,w:6.120699999999999,h:6.120699999999999,particleCount:1e6,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float a = cursor.zw.x;\nfloat b = cursor.zw.y;\nfloat sx = p.x/2.0;\nfloat sy = p.y/2.0;\nfloat i1x = sx*sx - sy*sy+a;\nfloat i1y = -2.0*sx*sy+b;\nfloat i2x = i1x*i1x - i1y*i1y+a;\nfloat i2y = -2.0*i1x*i1y+b;\nfloat i3x = i2x*i2x - i2y*i2y+a;\nfloat i3y = -2.0*i2x*i2y+b;\nfloat i4x = i3x*i3x - i3y*i3y+a;\nfloat i4y = -2.0*i3x*i3y+b;\nfloat i5x = i4x*i4x - i4y*i4y+a;\nfloat i5y = -2.0*i4x*i4y+b;\nfloat i6x = i5x*i5x - i5y*i5y+a;\nfloat i6y = -2.0*i5x*i5y+b;\nfloat i7x = i6x*i6x - i6y*i6y+a;\nfloat i7y = -2.0*i6x*i6y+b;\nfloat i8x = i7x*i7x - i7y*i7y+a;\nfloat i8y = -2.0*i7x*i7y+b;\nfloat i9x = i8x*i8x - i8y*i8y+a;\nfloat i9y = -2.0*i8x*i8y+b;\n\n  float n = sqrt(i9x*i9x+i9y*i9y);\n\nv.x = n > 2.0 ? -p.x/10.0 : p.x/10.0;\nv.y = n > 2.0 ? -p.y/10.0 : p.y/10.0;\n\n  return v;\n}"},{name:"Hyperjump",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,cx:.523299999999999,cy:1.2703999999999995,w:48.3842,h:48.3842,code:"vec2 circle(vec2 p, vec2 c) {\n  vec2 c0 = p - c;\n  vec2 p0 = vec2(-c0.y, c0.x);\n  float l = length(p0);\n  return p0 * exp(-l*sin(frame*0.01));\n}\n// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = circle(p, vec2(0., 0.));\n\n  float r = 7.;\n  for (int i = 0; i < 2; ++i) {\n    float a = 0.01 * frame + float(i) * 2.*PI/7.;\n    v += circle(p, vec2(r * cos(a) , r * sin(a)));\n  }\n  return v;\n}",particleCount:3e4},{name:"Particle Grinder",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.028149999999999675,cy:.08830000000000005,w:9.045300000000001,h:9.045300000000001,code:"vec2 tensor(vec2 p, vec2 c0, vec4 abcd, float N) {\n  vec2 p0 = p - c0;\n  float theta = atan(p0.y, p0.x);\n  float c = cos(N * theta);\n  float s = sin(N * theta);\n  return length(p0) * vec2(abcd[2] * c + abcd[3] * s,\n              abcd[0] * c + abcd[1] * s);\n}\n\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n  v = tensor(p, vec2(0., 0.), vec4(-2., 0., 0., 1.), 2.);\n  return v;\n}"},{name:"Hyperbolic flux [interactive]",timeStep:.001,fadeOut:.999,dropProbability:.009,colorMode:3,cx:-.11990000000000034,cy:.018899999999999917,w:8.5442,h:8.5442,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  float ax = (cursor.zw.x - p.x);\n  float ay = (cursor.zw.y - p.y);\n  float al = sqrt(ax*ax+ay*ay);\n\n  float rx = (p.x-cursor.xy.x);\n  float ry = (p.y-cursor.xy.y);\n  float rl = sqrt(rx*rx+ry*ry);\n\n  // change this to get a new vector field\n  v.x = (ax*ax*ry + ay*rx*rx)/(al*rl);\n  v.y = (ay*ay*rx + ax*ry*ry)/(al*rl);\n\n  return v;\n}",particleCount:1e6},{name:"Swim against the current",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:3.0524500000000003,cy:-1.3792,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dx1 = cursor.zw.x - p.x;\nfloat dy1 = cursor.zw.y - p.y;\nfloat dl1 = sqrt(dx1*dx1+dy1*dy1);\ndx1 = dx1/dl1;\ndy1 = dy1/dl1;\n\nfloat dx2 = cursor.xy.x - p.x;\nfloat dy2 = cursor.xy.y - p.y;\nfloat dl2 = sqrt(dx2*dx2+dy2*dy2);\ndx2 = dx2/dl2;\ndy2 = dy2/dl2;\n\nfloat fx = cursor.xy.x - cursor.zw.x;\nfloat fy = cursor.xy.y -\ncursor.zw.y;\nfloat fl = sqrt(fx*fx+fy*fy);\nfx = -fx/fl;\nfy = -fy/fl;\n\nfloat d1 = (dx1*fx + dy1*fy)/(dl1*fl);\nfloat d2 = 1.-d1;\nv.x = d1*fx+d2*dx2;\nv.y = d1*fy+d2*dy2;\n\n  return v;\n}",particleCount:100900},{name:"Eye of Sauron (interactive)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:.3991000000000007,cy:-.11315000000000008,w:37.0984,h:37.0984,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  // calculate distortion map (reverse solver)\n// the distortion map is based on a sphere, but smoothed to the ends: sqrt(1-(x^8/(x^8-1))^(1/4))\n\nfloat dist_radius = 7.8;\nvec2 distortion = cursor.zw;\nif (length(distortion) > 4.5) {\n    distortion = normalize(distortion) *4.5;\n}\n\n// iterative reverse algo. after all, we knew the result position already, we're trying to reason back to what the original position was\nvec2 d = p;\nfor (int i = 0; i < 10; i++) {\n    // calculate distortion effect magnitude\n    float d_scale = pow(length(d) / dist_radius, 8.);\n    // pseudo sphere map\n    d_scale = pow(1. - pow(d_scale / (d_scale + 1.), .25), .5);\n    d = p - distortion * d_scale;\n}\n\n// calculate differentials, working backwards (i.e. what change in p would result from a change in d)\nvec2 d_dx  = d + vec2(0.1, 0.0);\nfloat d_dx_scale = pow(length(d_dx) / dist_radius, 8.);\nd_dx_scale = pow(1. - pow(d_dx_scale / (d_dx_scale + 1.), .25), .5);\nvec2 dx = (d_dx + distortion * d_dx_scale - p) / 0.1;\n\nvec2 d_dy  = d + vec2(0.0, 0.1);\nfloat d_dy_scale = pow(length(d_dy) / dist_radius, 8.);\nd_dy_scale = pow(1. - pow(d_dy_scale / (d_dy_scale + 1.), .25), .5);\nvec2 dy = (d_dy + distortion * d_dy_scale - p) / 0.1;\n\n// center parts\nfloat pupilrange = length(vec2(d.y, d.x + 6.*sign(d.x)));\nvec2 pupilborder = 2.6*vec2(-d.y, (d.x + 6.*sign(d.x)) );\nv += pupilborder * smoothstep(6.6, 6.8, pupilrange) * (1. - smoothstep(6.9, 7.1, pupilrange));\n\nfloat range = length(d);\nvec2 iris = 7.*d/sqrt(range);\nv += iris * smoothstep(7.0, 7.5, pupilrange) * (1. - smoothstep(3.8, 4.0, range));\n\nvec2 pupil = 1.*vec2(d.x+1.*sign(d.x), d.y);\nv += pupil * (1. - smoothstep(6.6, 6.8, pupilrange));\n\n// absolute parts\nvec2 psign = sign(d);\nvec2 a = abs(d);\nvec2 vabs = vec2(0.0, 0.0);\n\nfloat borderrange = length(vec2(d.x, d.y + 7.*sign(d.y)));\nvec2 border = -1.5*vec2(a.y + 7.*sign(a.y) - 3./(a.y + 1.), -a.x + 3./(a.x + 1.));\nvabs += border * smoothstep(10.8, 11.25, borderrange) * (1. - smoothstep(11.25, 11.7, borderrange)) * smoothstep(3.8, 4.1, range) * (a.y / (a.y + 1.));\n\nvec2 irisborder = 5.*vec2(a.y, -a.x) * (a.y / (a.y + 3.))+ .2 * a;\nvabs += irisborder * smoothstep(3.8, 4.25, range) * (1. - smoothstep(4.25, 4.7, range));\n\nvec2 white = 12.*vec2(1.0, -0.2 * (a.y));\nvabs += white * smoothstep(4.3, 4.5, range) * (1. - smoothstep(11., 11.3, borderrange));\n\nv += vabs * psign;\n\n// outside part\nvec2 outside = d / pow(borderrange - 10., 2.);\nv -= outside * smoothstep(11.3, 11.5, borderrange);\n\n// velocity distortion mapping\nv = v.x * dx + v.y * dy;\n\n// color mapping\nif (length(v) > 0.01) {\n    v = normalize(v) * 10.;\n}\nv = v / (1. + 0.1 * (borderrange - 10.) * smoothstep(11.5, 12.5, borderrange));\n\n\n\n  return v;\n}",particleCount:3e4},{name:"Combination of two fields. One follows cursor",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 p1 = p - vec2(-2., 0.);\nvec2 p2 = p - cursor.zw;\n\nfloat l1 = length(p1), l2 = length(p2);\n\nv = vec2(-p1.y, p1.x)/(l1 * l1) + vec2(-p2.y, p2.x)/(l2 * l2);\n\n  return v;\n}"},{name:"[Randomized] nice symmetry",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:-2.6390499999999992,cy:-1.1419499999999996,w:46.508700000000005,h:46.508700000000005,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = p.y/cos(length(p));\n  v.y = max((log(p.y)+p.x),p.x);\n\n  return v;\n}",particleCount:2e4},{name:"A city block from a parallel Universe (by @MananG_8)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:1,cx:.6165500000000002,cy:-1.87745,w:9.0455,h:9.0455,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = sin(tan(p.x))*cos(tan(p.y));\n  v.y = sin(tan(p.y))*cos(tan(p.x));\n\n  return v;\n}\n",particleCount:2e4},{name:"♥ by @SAKrisT",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:2,cx:-1.4246499999999997,cy:.92285,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float size = 1.0;\n  vec2 o = (p)/(1.6* size);\n  float a = o.x*o.x+o.y*o.y-0.3;\n  v = vec2(step(a*a*a, o.x*o.x*o.y*o.y*o.y));\n\n  return v;\n}\n"},{name:"Dynamic vector field by Evgeniy Andreev. Not defined by physical system, but beautiful.",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-1.6564499999999995,cy:-.36424999999999974,w:24.7317,h:24.7317,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dt = 0.01;\n  float t = frame*dt;\n  float w = 2.*PI/5.;\n  float A = 2.;\n\n  float d = sqrt(p.x*p.x + p.y*p.y);\n  v.x = A*cos(w*t/d);\n  v.y = A*sin(w*t/d);\n\n  return v;\n}",particleCount:3e3},{name:"Behold (by /u/censored_username)",timeStep:.01,fadeOut:.988,dropProbability:.008,colorMode:2,cx:.12704999999999966,cy:.1923499999999998,w:22.5709,h:22.5709,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = abs(p.x) - 5.;\n  float side = sign(p.x);\n  float range = length(vec2(x, p.y));\n  float irisrange = length(vec2(x, p.y + 2.*sign(p.y)));\n\n  vec2 border = 1.*vec2(p.y + 2.2*sign(p.y) * (p.y*p.y / (p.y*p.y + 0.01)), -x);\n\n  vec2 outside = vec2(x / (1.+10./abs(p.x*p.x)), p.y);\n\n  vec2 spiral = vec2(p.y, -x);\n\n  vec2 iris = sin(-range * 10.) * spiral + 0.05*vec2(x, p.y);\n\n  v += outside * (smoothstep(4.0, 4.5, irisrange)/range*5. - 5.*smoothstep(0.9, 0.7, range)/range);\n  v += border * smoothstep(3.5, 4., irisrange) * smoothstep(4.5, 4., irisrange);\n  v += iris * smoothstep(2.0, 1.5, range) * smoothstep(0.8, 1., range);\n  v -= 10.0*spiral * smoothstep(1.0, 0.8, range) * smoothstep(0.7, 0.9, range);\n\n  v.x *= side;\n  v *= -1.;\n\n  return v;\n}",particleCount:3e4},{name:"README 1",timeStep:.007,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-1.275949999999999,cy:-1.6277,w:30.2937,h:30.2937,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = length(p)*min(sin(p.y),cos(p.x));\nv.y = cos((p.y+p.y));\n\n\n  return v;\n}"},{name:"README 2",timeStep:.007,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-1.275949999999999,cy:-1.62765,w:30.2937,h:30.2937,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = cos(p.y);\nv.y = cos(p.x);\n\n\n  return v;\n}"},{name:"README 3",timeStep:.02,fadeOut:.998,dropProbability:.009,colorMode:1,cx:.21419999999999995,cy:-.7710999999999997,w:55.970200000000006,h:55.970200000000006,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = min(sin(exp(p.x)),sin(length(p)));\nv.y = sin(p.x);\n\n\n  return v;\n}"},{name:"README 4",timeStep:.02,fadeOut:.998,dropProbability:.009,colorMode:1,cx:2.43185,cy:-1.1695,w:11.4385,h:11.4385,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = (p.y+cos(p.y));\nv.y = sin(min(length(p),log((p.y+p.x))*p.x));\n\n\n  return v;\n}"},{name:"True Dipole",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = p.x;\nfloat y = p.y;\n\n// true dipole\nv.x = 2.0*x*y;\nv.y = y*y - x*x;\n\n  return v;\n}"},{name:"Flow profile of a sphere",timeStep:.011,fadeOut:.99999,dropProbability:.009,colorMode:1,cx:-.7177000000000002,cy:-.11769999999999992,w:11.434999999999999,h:11.434999999999999,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float x = p.x;\nfloat y = p.y;\nfloat r = sqrt(x*x+y*y);\nfloat sinth = y/r;\nfloat costh = x/r;\nfloat R = 1.;\nfloat Uinf = 1.;\n// radial flow\nfloat ur = Uinf*(1.-1.5*R/r+0.5*R*R*R/(r*r*r))*costh;\n// theta flow\nfloat uth = Uinf*(-1.+0.75*R/r+0.25*R*R*R/(r*r*r))*sinth;\n// to ux uy\nv.x = costh*ur-sinth*uth;\nv.y = sinth*ur+costh*uth;\n\n  return v;\n}",particleCount:7e3},{name:"Best vortex",colorMode:2,cx:-6.158449999999998,cy:-.9834499999999995,w:96.8415,h:96.8415,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float r = length(p);\nfloat theta = atan(p.y, p.x);\nv = vec2(p.y, -p.x) / r;\nfloat t = sqrt(r * 10.) + theta + frame * .02;\nv *= sin(t);\nv *= length(v) * 10.;\nv += p * .2;\n\n  return v;\n}",timeStep:.01,fadeOut:.9,dropProbability:.009,particleCount:1e5},{name:"Black hole",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.47934999999999994,cy:.3591500000000001,w:8.5397,h:8.5397,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float a = .1;\nfloat r2 = p.x * p.x + p.y * p.y;\nv = vec2(p.y, -p.x) / r2 - a * p;\n\n  return v;\n}"},{name:"Julia set",timeStep:.004,fadeOut:.998,dropProbability:.009,colorMode:1,cx:-.40235,cy:-.01795000000000002,w:5.0845,h:5.0845,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 c = p;\nvec2 z = vec2(.4, .5);\nfor (int i = 0; i < 8; i++) {\n   c = vec2(c.x * c.x - c.y * c.y, c.y * c.x + c.x * c.y);\n   c += z;\n}\nv = c;\n\n\n  return v;\n}",particleCount:1e4},{name:"Mandelbrot set",timeStep:.004,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-.5678,cy:-.07015000000000005,w:4.9902,h:4.9902,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  vec2 z = p;\nfor(int k=0; k<50; k++) {\nz = vec2(z.x * z.x - z.y * z.y, 2. * z.x * z.y) + p;\n}\n\nfloat mask = step(length(z), 2.);\nv.x = -p.y/length(p) * (0.5 - mask);\nv.y = p.x/length(p) * (0.5 - mask);\n\n\n\n\n  return v;\n}",particleCount:3e4},{name:"Reflecting pool",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.5398,h:8.5398,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  v.x = sin(5.0*p.y + p.x);\nv.y = cos(5.0*p.x - p.y);\n\n  return v;\n}"},{name:"Shear zone",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:1,cx:0,cy:0,w:8.539734222673566,h:8.539734222673566,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float r = length(p) - 1.5;\nfloat c = 1.0/(1.0+exp(-5.0*r));\nfloat vx1 = -p.y,  // circle\n      vy1 = p.x;\nfloat vx2 = 0.2*p.x+p.y, // spiral\n      vy2 = 0.2*p.y-p.x;\nv.x = c*vx1 + (1.0-c)*vx2;\nv.y = c*vy1 + (1.0-c)*vy2;\n\n\n  return v;\n}"},{name:"Beautiful field",timeStep:.01,fadeOut:.998,dropProbability:.009,colorMode:3,cx:-1.6564499999999995,cy:-.36424999999999974,w:24.7317,h:24.7317,code:"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  float dt = 0.01;\nfloat t = frame*dt;\nfloat w = 2.*PI/5.;\nfloat A = 2.;\n\nfloat d = sqrt(p.x*p.x + p.y*p.y);\nv.x = A*cos(w*t/d);\nv.y = A*sin(w*t/d);\n\n  return v;\n}",particleCount:3e3}]},"7UaU":function(e,n,t){function o(e,n){function t(e,n){y.on("change",e,n)}function o(e,n){y.off("change",e,n)}function r(){return v}function u(){v.dispose(),y.off()}function s(e){return void 0===e?p:p[e]}function d(e,n){var t=typeof e;return"object"===t?Object.keys(e).forEach(function(n){p[n]=e[n]}):"string"===t&&(p[e]=n),v.set(p),x}function f(e){p=e,y.fire("change",p)}function l(e,n){if("object"==typeof e&&Object.keys(e).forEach(function(n){n in p||(p[n]=e[n])}),!(e in p))return p[e]=n,v.set(p),x}n=n||{};var v=n.history||c(e,n);a(v),v.onChanged(f);var p=v.get()||Object.create(null),x={get:s,set:d,setIfEmpty:l,dispose:u,onChange:t,offChange:o,getHistoryObject:r},y=i({});return x}function r(e){return u?e&&u.setIfEmpty(e):u=o(e),u}function a(e){if(!e)throw new Error("history is required");if("function"!=typeof e.dispose)throw new Error("dispose is required");if("function"!=typeof e.onChanged)throw new Error("onChanged is required")}e.exports=o;var i=t("fkI9"),c=t("2PgA");o.instance=r;var u},"85ps":function(e,n,t){"use strict";function o(e){return t.i(s.a)(e).then(function(n){if(n.error)return n;e=n.getCode();var t=d.check(e,{globals:f});return t.code=e,t.log.errorCount&&(t.error=r(t.log)),t})}function r(e){var n=e.diagnostics[0],t=n.range,o=t.lineColumn(),r=t.source,c=r._lineOffsets[o.line],u=r.contents.substr(c,o.column);u+=r.contents.substring(t.start,t.end);var s="Line "+o.line+": ",d=n.text;return{error:s+u+"\n"+i(s.length)+i(o.column)+"^",errorDetail:d,isFloatError:a(d)}}function a(e){return e.indexOf('"int"')>-1&&e.indexOf('"float"')>-1}function i(e){return new Array(e+1).join(" ")}n.a=o;var c=t("eBcr"),u=t.n(c),s=t("svlg"),d={check:function(e){return{code:e,log:{errorCount:0}}}};t.e(2).then(function(){d=t("TFw8"),u.a.fire("glsl-parser-ready")}.bind(null,t)).catch(t.oe);var f="\nimport {\n  float PI;\n  float snoise(vec2 v);\n  float frame;\n  vec4 cursor;\n  vec2 rotate(vec2 p,float a);\n  float audio(float index);\n  float rand(const vec2 co);\n  sampler2D input0;\n  sampler2D input1;\n}"},"94y8":function(e,n,t){"use strict";function o(e){function n(){a.a.off("audio",o),r.deleteTexture(u)}function t(){if(s){s=!1;r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,5,5,0,r.RGBA,r.UNSIGNED_BYTE,c),r.bindTexture(r.TEXTURE_2D,null)}}function o(e){c=e,s=!0}var r=e.gl,c=new Uint8Array(256),u=i.a.createTexture(r,r.NEAREST,c,8,8),s=!1;return e.audioTexture=u,a.a.on("audio",o),{updateTextures:t,dispose:n}}var r=t("eBcr"),a=t.n(r),i=t("Ddjs");n.a=o},"9XuS":function(e,n){function t(e){function n(n){var t=e[n],o=a(n);return void 0!==t&&(o+="="+r(t)),o}return e?Object.keys(e).map(n).join("&"):""}function o(e){function n(e){if(e){var n=e.split("=");t[decodeURIComponent(n[0])]=c(n[1])}}var t=Object.create(null);return e?(e.split("&").forEach(n),t):t}function r(e){return e instanceof Date&&(e=e.toISOString()),a(e)}function a(e){return encodeURIComponent(e).replace(/[()]/g,i)}function i(e){return")"===e?"%29":"("===e?"%28":e}function c(e){return e=decodeURIComponent(e),""===e?e:isNaN(e)?u(e)?"true"===e:s(e)?new Date(e):e:parseFloat(e)}function u(e){return"true"===e||"false"===e}function s(e){return e&&e.match(/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/)}e.exports={parse:o,stringify:t}},C8nW:function(e,n,t){"use strict";function o(e,n){function t(t,o){function r(e){e.lengthComputable&&n.progress({loaded:e.loaded,total:e.total,percent:e.loaded/e.total})}function a(){if(200!==u.status)return void o("Unexpected status code "+u.status+" when calling "+e);var r=u.response;"json"===n.responseType&&"string"==typeof r&&(r=JSON.parse(r)),t(r)}function i(){o("Failed to download "+e)}function c(){o("Cancelled download of "+e)}var u=new XMLHttpRequest;"function"==typeof n.progress&&u.addEventListener("progress",r,!1),u.addEventListener("load",a,!1),u.addEventListener("error",i,!1),u.addEventListener("abort",c,!1),u.open("GET",e),n.responseType&&(u.responseType=n.responseType),u.send(null)}return n||(n={}),new a.a(t)}n.a=o;var r=t("//Fk"),a=t.n(r)},Ddjs:function(e,n,t){"use strict";function o(e,n,t){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,n)}function r(e,n){var t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),t}function a(e,n,t,o,r){var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),t instanceof Uint8Array?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,o,r,0,e.RGBA,e.UNSIGNED_BYTE,t):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null),a}function i(e,n,t){e.bindFramebuffer(e.FRAMEBUFFER,n),t&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}function c(e,n,t,o){e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,o,e.FLOAT,!1,0,0)}function u(e,n,t){function o(){e.deleteProgram(r)}var r=e.createProgram(),a=s(e,e.VERTEX_SHADER,n),i=s(e,e.FRAGMENT_SHADER,t);if(e.attachShader(r,a),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(r));var c,u={program:r,unload:o},d=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES);for(c=0;c<d;c++){var f=e.getActiveAttrib(r,c);u[f.name]=e.getAttribLocation(r,f.name)}var l=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(c=0;c<l;c++){var v=e.getActiveUniform(r,c);u[v.name]=e.getUniformLocation(r,v.name)}return u}function s(e,n,t){var o=e.createShader(n);if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(o));return o}n.a={createTexture:a,bindFramebuffer:i,createProgram:u,createBuffer:r,bindAttribute:c,bindTexture:o}},DuZ1:function(e,n,t){"use strict";var o=t("Zx67"),r=t.n(o),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),v=t("4KA4"),p=t("JjDM"),x=t("bvb0"),y=function(e){function n(e){i()(this,n);var t=d()(this,(n.__proto__||r()(n)).call(this));return t.updateCode=e||"",t}return l()(n,e),u()(n,[{key:"setNewUpdateCode",value:function(e){this.updateCode=e}},{key:"getDefines",value:function(){return"\nuniform float frame;\nuniform vec4 cursor;\n// TODO: use inputN instead.\nuniform sampler2D u_audio;\n\n#define PI 3.1415926535897932384626433832795\n\n"+t.i(x.a)()+"\n"}},{key:"getFunctions",value:function(){return"\n    // pseudo-random generator\nconst vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);\nfloat rand(const vec2 co) {\n    float t = dot(rand_constants.xy, co);\n    return fract(sin(t) * (rand_constants.z + t));\n}\n\n"+p.a+"\n\nvec2 rotate(vec2 p,float a) {\n\treturn cos(a)*p+sin(a)*vec2(p.y,-p.x);\n}\n\n// TODO: This will change. Don't use it.\nfloat audio(float index) {\n  float rgbI = floor(index/4.);\n  vec2 txPos = vec2(fract(rgbI / 5.), floor(rgbI / 5.) / 5.);\n  vec4 rgba = texture2D(u_audio, txPos);\n  \n  float offset = mod(index, 4.);\n  if (offset == 0.) return rgba[0];\n  if (offset == 1.) return rgba[1];\n  if (offset == 2.) return rgba[2];\n  return rgba[3];\n}\n\n"+(this.updateCode?this.updateCode:"vec2 get_velocity(vec2 p) { return vec2(0.); }")+"\n  "}}]),n}(v.a);n.a=y},FaU1:function(e,n,t){"use strict";function o(e,n,t){if(0==e)return n[t+0]=0,n[t+1]=0,n[t+2]=0,void(n[t+3]=0);var o=Math.abs(e),r=Math.floor(c()(o));r+=a(r)<=o/2?1:0,r-=a(r)>o?1:0;var i;i=r>100?o/1024/a(r-10)-1:o/a(r)-1;var u=r+127;i*=256;var s=Math.floor(i);i-=s,i*=256;var d=Math.floor(i);i-=d,i*=128;var f=2*Math.floor(i)+(e<0?1:0);n[t+0]=u,n[t+1]=s,n[t+2]=d,n[t+3]=f}function r(e,n,t,o){var r=Math.floor(e+.5),i=Math.floor(n+.5),c=Math.floor(t+.5),u=Math.floor(o+.5),s=r-127;return(1-u%2*2)*((r>0?1:0)+i/256+c/65536+Math.floor(u/2)/8388608)*a(s)}function a(e){return Math.exp(e*Math.LN2)}n.a=o,n.b=r;var i=t("yI0F"),c=t.n(i)},"I6d+":function(e,n,t){"use strict";function o(e,n,o){function i(e){o&&o.error&&o.error(e)}function c(e){f=e,u.a.fire("refresh-speed"),o&&o.done&&o.done(n)}function d(n,t){if(f){var o=t+s;a.a.bindTexture(e.gl,f,o),e.gl.uniform1i(n["input"+t],o)}}var f=null;return t.i(r.a)(e.gl,n).then(c).catch(i),{updateBinding:d,dispose:function(){e.gl.deleteTexture(f)}}}n.a=o;var r=t("egvE"),a=t("Ddjs"),i=t("rvz5"),c=t("eBcr"),u=t.n(c),s=i.a.FREE_TEXTURE_UNIT},JHsM:function(e,n,t){"use strict";function o(e){function n(e){if(e){var n=s()({},Z.bbox);if(o(e,"minX",n),o(e,"minY",n),o(e,"maxX",n),o(e,"maxY",n),void 0!==e.minY||void 0!==e.maxY){var t=Math.abs(n.minY-n.maxY)/Math.abs(Z.bbox.minY-Z.bbox.maxY),r=(Z.bbox.maxX+Z.bbox.minX)/2,a=(Z.bbox.maxX-Z.bbox.minX)/2;n.minX=r-a*t,n.maxX=r+a*t}z(n)}}function o(e,n,t){var o=c()(e[n]);a()(o)&&(t[n]=o)}function r(e){G=e}function i(){G=null}function u(e){var n=parseInt(e,10);x.a.setColorMode(n),Z.colorMode=x.a.getColorMode(),Q.updateColorMode(n)}function f(){return x.a.getColorMode()}function v(){return x.a.getIntegrationTimeStep()}function w(e){var n=parseFloat(e);a()(n)&&(Z.integrationTimeStep=n,x.a.setIntegrationTimeStep(n),p.a.fire("integration-timestep-changed",n))}function E(e){H=e,B()}function T(e){var n=parseFloat(e);a()(n)&&(Z.fadeOpacity=n,x.a.setFadeout(n))}function P(){return x.a.getFadeout()}function M(){return x.a.getParticleCount()}function S(e){a()(e)&&e!==V&&(e<1||(U(e),V=e,x.a.setParticleCount(e)))}function C(e){var n=parseFloat(e);a()(n)&&(x.a.setDropProbability(n),Z.dropProbability=n)}function R(){return x.a.getDropProbability()}function A(){F(window.innerWidth,window.innerHeight),J.updateScreenTextures(),N(q)}function F(n,t){var o=Math.max(.02*n,30),r=Math.max(.02*t,30);L.width=n+2*o,L.height=t+2*r,L.top=-r,L.left=-o;var a=e.canvas;a.width=L.width,a.height=L.height,a.style.left=-o+"px",a.style.top=-r+"px"}function D(){O(),te.dispose(),window.removeEventListener("resize",A,!0),$.dispose(),ee.dispose()}function B(){W||H||(W=requestAnimationFrame(I))}function O(){cancelAnimationFrame(W),W=0}function I(){W=0,X(),G&&G.capture(e.canvas),B()}function X(){J.fadeOutLastFrame(),Q.drawParticles(),J.renderCurrentScreen(),Q.updateParticlesPositions()}function U(e){Z.particleStateResolution=Math.ceil(Math.sqrt(e)),Q.updateParticlesCount()}function k(){var e=x.a.getBBox(),n=L.width,t=L.height,o=Math.PI*Math.E,r=Math.PI*Math.E,a=0,i=0;e&&(o=e.maxX-e.minX,r=e.maxY-e.minY,a=n*(e.minX+e.maxX)/2,i=n*(e.minY+e.maxY)/2);var c=o*n/2,u=r*t/2;te.showRectangle({left:-c+a,top:-u-i,right:c+a,bottom:u-i})}function N(e){function n(n){return(n-e.x)/e.scale}function t(n){return(n-e.y)/e.scale}J.boundingBoxUpdated=!0,q.x=e.x,q.y=e.y,q.scale=e.scale;var o=L.width,r=L.height,a=n(0),i=t(0),c=n(o),u=t(r),s=1e4;j.minX=Math.round(s*a/o)/s,j.minY=Math.round(s*-i/o)/s,j.maxX=Math.round(s*c/o)/s,j.maxY=Math.round(s*-u/o)/s,x.a.saveBBox(j),p.a.fire("bbox-change",j)}function Y(){var e=Math.PI*Math.E*.5,n=Math.PI*Math.E*.5;z({minX:-e,minY:-n,maxX:e,maxY:n})}function z(e){x.a.saveBBox(e,!0),k(),te.moveBy(0,0,!1)}var L={width:0,height:0,top:0,left:0};F(e.canvas.width,e.canvas.height),window.addEventListener("resize",A,!0),p.a.on("start-record",r),p.a.on("stop-record",i);var G=null,j=x.a.getBBox()||{},q={scale:1,x:0,y:0},V=x.a.getParticleCount();e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST);var W,Z={gl:e,bbox:j,canvasRect:L,inputs:null,framebuffer:e.createFramebuffer(),quadBuffer:d.a.createBuffer(e,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),colorMode:x.a.getColorMode(),colorFunction:x.a.getColorFunction(),screenTextureUnit:3,integrationTimeStep:x.a.getIntegrationTimeStep(),dropProbability:x.a.getDropProbability(),frame:0,cursor:{clickX:0,clickY:0,hoverX:0,hoverY:0},particleStateResolution:0,fadeOpacity:x.a.getFadeout(),audioTexture:null},H=!1,K=t.i(_.a)(Z),J=t.i(g.a)(Z),Q=t.i(m.a)(Z),$=t.i(h.a)(Z),ee=t.i(b.a)(Q);U(V);var ne={start:B,stop:O,dispose:D,resetBoundingBox:Y,moveBoundingBox:n,applyBoundingBox:z,setPaused:E,getParticlesCount:M,setParticlesCount:S,setFadeOutSpeed:T,getFadeOutSpeed:P,setDropProbability:C,getDropProbability:R,getIntegrationTimeStep:v,setIntegrationTimeStep:w,setColorMode:u,getColorMode:f,vectorFieldEditorState:ee,inputsModel:K,getCanvasRect:function(){return L},getBoundingBox:function(){return Z.bbox}},te=function(){return l()(e.canvas,{realPinch:!0,zoomSpeed:.025,controller:t.i(y.a)(e.canvas,N)})}();return k(),setTimeout(function(){p.a.fire("scene-ready",ne)}),ne}n.a=o;var r=t("AMV0"),a=t.n(r),i=t("5dBV"),c=t.n(i),u=t("woOf"),s=t.n(u),d=t("Ddjs"),f=t("yBIK"),l=t.n(f),v=t("eBcr"),p=t.n(v),x=t("NEgR"),y=t("p0IO"),g=t("h62Y"),m=t("pKWO"),h=t("p9aJ"),b=t("c5hq"),_=t("/eR5")},JjDM:function(e,n,t){"use strict";n.a="\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n"},NEgR:function(e,n,t){"use strict";function o(){var e=O.get("cm");return w(e)?e:U.colorMode}function r(e){w(e)&&(O.set({cm:e}),I.cm=e)}function a(){return O.get("cf")||""}function i(e){O.set({cf:e}),I.cf=e}function c(){var e=O.get("fo");return w(e)?e:U.fadeout}function u(e){w(e)&&(O.set({fo:e}),I.fo=e)}function s(){var e=O.get("pc");return w(e)?e:U.particleCount}function d(e){w(e)&&(O.set({pc:e}),I.pc=e)}function f(){var e=O.get("dt");return w(e)?e:U.timeStep}function l(e){w(e)&&(O.set({dt:e}),I.dt=e)}function v(){var e=O.get("dp");return w(e)?e:U.dropProbability}function p(e){w(e)&&(E(e,0,1),O.set({dp:e}))}function x(){return y(O.get("cx"),O.get("cy"),O.get("w"),O.get("h"))}function y(e,n,t,o){if(w(e)&&w(n)&&w(t)&&w(o)){var r=t/2,a=o/2,i=1e4;return{minX:Math.round(i*(e-r))/i,maxX:Math.round(i*(e+r))/i,minY:Math.round(i*(n-a))/i,maxY:Math.round(i*(n+a))/i}}}function g(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];T&&(clearTimeout(T),T=0),n?m(e):T=setTimeout(function(){return m(e)},300)}function m(e){T=0;var e={cx:.5*(e.minX+e.maxX),cy:.5*(e.minY+e.maxY),w:e.maxX-e.minX,h:e.maxX-e.minX};e.w<=0||e.h<=0||(O.set(e),I.cx=e.cx,I.cy=e.cy,I.w=e.w,I.h=e.h)}function h(){var e=O.get("vf");if(e)return e;var n=O.get("code");return n?(e=t.i(D.a)(n),delete I.code,O.set("vf",e),e):X}function b(){return X}function _(e){O.set({vf:e}),I.code=e}function w(e){return M()(e)}function E(e,n,t){return e<n?n:e>t?t:e}var T,P=t("AMV0"),M=t.n(P),S=t("7UaU"),C=t.n(S),R=t("eBcr"),A=t.n(R),F=t("6c6E"),D=t("cj2E"),B=t("bwl9"),O=C()({},{useSearch:!0,rewriteHashToSearch:!0}),I=O.get(),X=t.i(D.a)("v.x = 0.1 * p.y;\n  v.y = -0.2 * p.y;"),U={timeStep:.01,dropProbability:.009,particleCount:1e4,fadeout:.998,colorMode:F.a.UNIFORM},k={collapsed:t.i(B.a)()};n.a={settingsPanel:k,saveBBox:g,getBBox:x,makeBBox:y,getQS:function(){return O},saveCode:_,getCode:h,getDefaultCode:b,getDropProbability:v,setDropProbability:p,getIntegrationTimeStep:f,setIntegrationTimeStep:l,getParticleCount:s,setParticleCount:d,getFadeout:c,setFadeout:u,getColorMode:o,setColorMode:r,getColorFunction:a,setColorFunction:i},O.onChange(function(){A.a.fire("scene-ready",window.scene)})},Qv35:function(e,n,t){"use strict";var o=t("Zx67"),r=t.n(o),a=t("zwoO"),i=t.n(a),c=t("Pf15"),u=t.n(c),s=t("Zrlr"),d=t.n(s),f=t("wxAW"),l=t.n(f),v=t("4KA4"),p=t("XMEc"),x=t("S+/9"),y=t("DuZ1"),g=t("vhRe"),m=t("i69e"),h=function(){function e(n){d()(this,e),this.readStoredPosition=new p.a(!0),this.udfVelocity=new y.a,this.integratePositions=new m.a,this.dropParticles=new b,this.writeComputedPosition=new p.a(!1),this.panZoomDecode=new g.a({decode:!0}),this.panZoomEncode=new g.a({decode:!1}),this.colorMode=n&&n.colorMode}return l()(e,[{key:"setCustomVectorField",value:function(e){this.udfVelocity.setNewUpdateCode(e)}},{key:"getVertexShader",value:function(){return"precision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);\n}"}},{key:"getFragmentShader",value:function(){var e=[this.readStoredPosition,this.dropParticles,this.udfVelocity,this.integratePositions,{getMainBody:function(){return"\n  vec2 newPos = pos + velocity;\n  "}},this.writeComputedPosition];return t.i(x.a)(e)}}]),e}();n.a=h;var b=function(e){function n(){return d()(this,n),i()(this,(n.__proto__||r()(n)).apply(this,arguments))}return u()(n,e),l()(n,[{key:"getDefines",value:function(){return"\nuniform float u_drop_rate;\nuniform float u_rand_seed;\nuniform vec2 u_min;\nuniform vec2 u_max;\n"}},{key:"getFunctions",value:function(){return"\n"}},{key:"getMainBody",value:function(){return"\n  // a random seed to use for the particle drop\n  vec2 seed = (pos + v_tex_pos) * u_rand_seed;\n  // drop rate is a chance a particle will restart at random position, to avoid degeneration\n  float drop = step(1.0 - u_drop_rate, rand(seed));\n\n  // TODO: This can be customized to produce various emitters\n  // random_pos is in range from 0..1, we move it to the bounding box:\n  vec2 random_pos = vec2(rand(seed + 1.9), rand(seed + 8.4)) * (u_max - u_min) + u_min;\n  pos = mix(pos, random_pos, drop);\n"}}]),n}(v.a)},"S+/9":function(e,n,t){"use strict";function o(e){function n(e){e&&t.push(e)}var t=[];return e.forEach(function(e){e.getDefines&&n(e.getDefines())}),e.forEach(function(e){e.getFunctions&&n(e.getFunctions())}),n("void main() {"),e.forEach(function(e){e.getMainBody&&n(e.getMainBody())}),n("}"),t.join("\n")}n.a=o},V39N:function(e,n,t){"use strict";function o(){function e(){n=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY}var n,t;return{getMin:function(){return n},getMax:function(){return t},add:function(e){e<n&&(n=e),e>t&&(t=e)},reset:e}}n.a=o},XFig:function(e,n,t){"use strict";n.a="\nhighp float decodeFloatRGBA( vec4 v ) {\n  float a = floor(v.r * 255.0 + 0.5);\n  float b = floor(v.g * 255.0 + 0.5);\n  float c = floor(v.b * 255.0 + 0.5);\n  float d = floor(v.a * 255.0 + 0.5);\n\n  float exponent = a - 127.0;\n  float sign = 1.0 - mod(d, 2.0)*2.0;\n  float mantissa = float(a > 0.0)\n                  + b / 256.0\n                  + c / 65536.0\n                  + floor(d / 2.0) / 8388608.0;\n  return sign * mantissa * exp2(exponent);\n}\n"},XMEc:function(e,n,t){"use strict";var o=t("Zx67"),r=t.n(o),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),v=t("4KA4"),p=t("a8s+"),x=t("XFig"),y=function(e){function n(e){i()(this,n);var t=d()(this,(n.__proto__||r()(n)).call(this));return t.isDecode=e,t}return l()(n,e),u()(n,[{key:"getFunctions",value:function(){if(this.isDecode)return"\n    "+p.a+"\n    "+x.a+"\n"}},{key:"getDefines",value:function(){if(this.isDecode)return"\nprecision highp float;\n\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n\n// Which coordinate needs to be printed onto the texture\nuniform int u_out_coordinate;\n\nvarying vec2 v_tex_pos;\n"}},{key:"getMainBody",value:function(){return this.isDecode?"\n   vec2 pos = vec2(\n     decodeFloatRGBA(texture2D(u_particles_x, v_tex_pos)),\n     decodeFloatRGBA(texture2D(u_particles_y, v_tex_pos))\n   );\n":"\n    if (u_out_coordinate == 0) gl_FragColor = encodeFloatRGBA(newPos.x);\n    else if (u_out_coordinate == 1) gl_FragColor = encodeFloatRGBA(newPos.y);\n    else if (u_out_coordinate == 6) gl_FragColor = encodeFloatRGBA(get_velocity(pos).x);\n    else if (u_out_coordinate == 7) gl_FragColor = encodeFloatRGBA(get_velocity(pos).y);\n"}}]),n}(v.a);n.a=y},YJWA:function(e,n,t){"use strict";function o(e){if(!f)return void t.e(1).then(function(){f=t("nI+d"),window.stopRecord=a,o(e)}.bind(null,t)).catch(t.oe);if(l&&l.stop(),!r()){var n=document.createElement("script");return n.setAttribute("src",e||"http://localhost:8080/ffmpegserver/ffmpegserver.js"),n.onload=function(){return o(e)},void document.head.appendChild(n)}l=new f({format:"ffmpegserver",framerate:60,verbose:!0,name:"fieldplay",extension:".mp4",codec:"mpeg4",ffmpegArguments:["-b:v","12M"]}),window.isRecording=!0,l.start(),u.a.fire("start-record",l)}function r(){return"undefined"!=typeof FFMpegServer}function a(){window.isRecording=!1,u.a.fire("stop-record",l),l.stop(),l.save()}Object.defineProperty(n,"__esModule",{value:!0});var i=t("JHsM"),c=t("eBcr"),u=t.n(c),s=t("sbZs"),d=document.getElementById("scene");d&&function(e){e.width=window.innerWidth,e.height=window.innerHeight;var n={antialiasing:!1},o=e.getContext("webgl",n)||e.getContext("experimental-webgl",n);if(o){window.webGLEnabled=!0;var r=t.i(i.a)(o);r.start(),t.i(s.a)(r),window.scene=r}else window.webGLEnabled=!1}(d),t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var f,l;window.startRecord=o,window.isRecording=!1},"a8s+":function(e,n,t){"use strict";n.a="\nvec4 encodeFloatRGBA(highp float val) {\n    if (val == 0.0) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    float mag = abs(val);\n    float exponent = floor(log2(mag));\n    // Correct log2 approximation errors.\n    exponent += float(exp2(exponent) <= mag / 2.0);\n    exponent -= float(exp2(exponent) > mag);\n\n    float mantissa;\n    if (exponent > 100.0) {\n        // Not sure why this needs to be done in two steps for the largest float to work.\n        // Best guess is the optimizer rewriting '/ exp2(e)' into '* exp2(-e)',\n        // but exp2(-128.0) is too small to represent.\n        mantissa = mag / 1024.0 / exp2(exponent - 10.0) - 1.0;\n    } else {\n        mantissa = mag / float(exp2(exponent)) - 1.0;\n    }\n\n    float a = exponent + 127.0;\n    mantissa *= 256.0;\n    float b = floor(mantissa);\n    mantissa -= b;\n    mantissa *= 256.0;\n    float c = floor(mantissa);\n    mantissa -= c;\n    mantissa *= 128.0;\n    float d = floor(mantissa) * 2.0 + float(val < 0.0);\n    return vec4(a, b, c, d) / 255.0;\n}\n"},aZPT:function(e,n,t){"use strict";function o(e,n){e.getMethods&&n.push(e.getMethods())}function r(e,n){e.getMain&&n.push(e.getMain())}function a(){function e(){return"\nuniform sampler2D u_particles_x;\nuniform sampler2D u_particles_y;\n    "}function n(){return"\n  vec2 v_particle_pos = vec2(\n    decodeFloatRGBA(texture2D(u_particles_x, txPos)),\n    decodeFloatRGBA(texture2D(u_particles_y, txPos))\n  );\n"}return{getVariables:e,getMain:n}}var i=t("Zrlr"),c=t.n(i),u=t("wxAW"),s=t.n(u),d=t("XFig"),f=t("c5NW"),l=function(){function e(n){c()(this,e),this.colorMode=n.colorMode,this.colorFunction=n.colorFunction||""}return s()(e,[{key:"getFragmentShader",value:function(){return"precision highp float;\nvarying vec4 v_particle_color;\nvoid main() {\n  gl_FragColor = v_particle_color;\n}"}},{key:"getVertexShader",value:function(e){var n=a(),i=t.i(f.a)(this.colorMode,e,this.colorFunction),c=[];o(n,c),o(i,c);var u=[];return r(n,u),r(i,u),"precision highp float;\nattribute float a_index;\nuniform float u_particles_res;\nuniform vec2 u_min;\nuniform vec2 u_max;\n\n"+(n.getVariables()||"")+"\n"+i.getVariables()+"\n\n"+d.a+"\n\n"+c.join("\n")+"\n\nvoid main() {\n  vec2 txPos = vec2(\n        fract(a_index / u_particles_res),\n        floor(a_index / u_particles_res) / u_particles_res);\n  gl_PointSize = 1.0;\n\n"+u.join("\n")+"\n\n  vec2 du = (u_max - u_min);\n  v_particle_pos = (v_particle_pos - u_min)/du;\n  gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, (1. - 2. * (v_particle_pos.y)),  0., 1.);\n}"}}]),e}();n.a=l},bvb0:function(e,n,t){"use strict";function o(){return"uniform sampler2D input0;\nuniform sampler2D input1;"}n.a=o},bwl9:function(e,n,t){"use strict";function o(){return window.innerWidth<600}n.a=o},c5NW:function(e,n,t){"use strict";function o(e,n,t){function o(){return"\nuniform vec2 u_velocity_range;\nvarying vec4 v_particle_color;\n\n"+d.getDefines()+"\n"+f.getDefines()+"\n"}function c(){return"\n// https://github.com/hughsk/glsl-hsv2rgb\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n"+d.getFunctions()+"\n"+f.getFunctions()+"\n"+u()+"\n"}function u(){if(e===i.a.UNIFORM)return"\nvec4 get_color(vec2 p) {\n  return vec4(0.302, 0.737, 0.788, 1.);\n}\n";if(e===i.a.VELOCITY)return"\nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (length(velocity) - u_velocity_range[0])/(u_velocity_range[1] - u_velocity_range[0]);\n  return vec4(hsv2rgb(vec3(0.05 + (1. - speed) * 0.5, 0.9, 1.)), 1.0);\n}\n";if(e===i.a.CUSTOM){if(!t)throw new Error("color mode is set to custom, but no color function is specified");return t}return" \nvec4 get_color(vec2 p) {\n  vec2 velocity = get_velocity(p);\n  float speed = (atan(velocity.y, velocity.x) + PI)/(2.0 * PI);\n  return vec4(hsv2rgb(vec3(speed, 0.9, 1.)), 1.0);\n}\n"}function s(){return"  v_particle_color = get_color(v_particle_pos);"}var d=new r.a(n),f=new a.a;return{getVariables:o,getMain:s,getMethods:c}}n.a=o;var r=t("DuZ1"),a=t("i69e"),i=t("6c6E")},c5hq:function(e,n,t){"use strict";function o(e){function n(){a.a.off("glsl-parser-ready",s)}function o(){return i.a.getCode()}function r(e){if(e===v)return void(f&&f.error&&s());d(e).then(function(n){if(!n.cancelled){if(n&&n.error)return u(n.error),n;v=e,p.code=e,i.a.saveCode(e)}})}function u(e){e&&e.error?(p.error=e.error,p.errorDetail=e.errorDetail,p.isFloatError=e.isFloatError):(p.error="",p.errorDetail="",p.isFloatError=!1)}function s(e){return t.i(c.a)(e||v).then(function(e){return f=e,u(f.error),f})}function d(n){l+=1;var t=l;return s(n).then(function(n){if(t!==l)return n.cancelled=!0,n;if(n.error)return n;try{return e.updateCode(n.code),n}catch(e){return{error:{error:e.message}}}})}a.a.on("glsl-parser-ready",s);var f,l=0,v=i.a.getCode();!function(){var e=i.a.getCode();e?d(e).then(function(e){e.error&&(console.error("Failed to restore previous vector field: ",e.error),d(i.a.getDefaultCode()))}):d(i.a.getDefaultCode())}();var p={getCode:o,setCode:r,dispose:n,code:v,error:"",errorDetail:"",isFloatError:!1};return p}n.a=o;var r=t("eBcr"),a=t.n(r),i=t("NEgR"),c=t("85ps")},cj2E:function(e,n,t){"use strict";function o(e){return"// p.x and p.y are current coordinates\n// v.x and v.y is a velocity at point p\nvec2 get_velocity(vec2 p) {\n  vec2 v = vec2(0., 0.);\n\n  // change this to get a new vector field\n  "+e+"\n\n  return v;\n}"}n.a=o},eBcr:function(e,n,t){var o=t("puH/");e.exports=o({})},egvE:function(e,n,t){"use strict";function o(e,n){function t(e){c(e)}function o(){var n=e.createTexture(),t=e.RGBA,o=e.RGBA,i=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t,o,i,u),r(u.width)&&r(u.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),a(n)}var a,c,u=new Image;return u.crossOrigin="",u.onload=o,u.onerror=t,u.src=n,new i.a(function(e,n){a=e,c=n})}function r(e){return 0==(e&e-1)}n.a=o;var a=t("//Fk"),i=t.n(a)},fkI9:function(e,n){function t(e){var n=Object.create(null);return{on:function(t,o,r){if("function"!=typeof o)throw new Error("callback is expected to be a function");var a=n[t];return a||(a=n[t]=[]),a.push({callback:o,ctx:r}),e},off:function(t,o){if(void 0===t)return n=Object.create(null),e;if(n[t]){if("function"!=typeof o)delete n[t];else for(var r=n[t],a=0;a<r.length;++a)r[a].callback===o&&r.splice(a,1)}return e},fire:function(t){var o=n[t];if(!o)return e;var r;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var a=0;a<o.length;++a){var i=o[a];i.callback.apply(i.ctx,r)}return e}}}function o(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],t=0;t<n.length;++t)if(e.hasOwnProperty(n[t]))throw new Error("Subject cannot be eventified, since it already has property '"+n[t]+"'")}e.exports=function(e){o(e);var n=t(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e}},gIFv:function(e,n,t){"use strict";function o(e){function n(){c.a.off("integration-timestep-changed",i),c.a.off("bbox-change",i),c.a.off("refresh-speed",i),o()}function o(){g&&T.deleteTexture(g),y&&T.deleteTexture(y)}function i(){h&&clearTimeout(h),h=setTimeout(function(){E=!0,h=0},50)}function u(e){T.uniform2f(e.u_velocity_range,P.getMin(),P.getMax())}function l(){o(),m=e.particleStateResolution,b=m*m,_=new Uint8Array(4*b),w=new Uint8Array(4*b),g=a.a.createTexture(T,T.NEAREST,_,m,m),y=a.a.createTexture(T,T.NEAREST,w,m,m),i()}function v(){i()}function p(n){E&&_&&w&&(E=!1,a.a.bindFramebuffer(T,e.framebuffer,g),T.uniform1i(n.u_out_coordinate,d),T.drawArrays(T.TRIANGLES,0,6),T.readPixels(0,0,m,m,T.RGBA,T.UNSIGNED_BYTE,_),a.a.bindFramebuffer(T,e.framebuffer,y),T.uniform1i(n.u_out_coordinate,f),T.drawArrays(T.TRIANGLES,0,6),T.readPixels(0,0,m,m,T.RGBA,T.UNSIGNED_BYTE,w),x())}function x(){P.reset();for(var e=0;e<w.length;e+=4){var n=r(_,e),t=r(w,e),o=Math.sqrt(n*n+t*t);P.add(o)}}var y,g,m,h,b,_,w,E=!0,T=e.gl,P=t.i(s.a)();return function(){c.a.on("integration-timestep-changed",i),c.a.on("bbox-change",i),c.a.on("refresh-speed",i)}(),{updateCode:v,updateParticlesPositions:p,updateParticlesCount:l,setColorMinMax:u,requestSpeedUpdate:i,dispose:n}}function r(e,n){return t.i(u.b)(e[n+0],e[n+1],e[n+2],e[n+3])}n.a=o;var a=t("Ddjs"),i=t("eBcr"),c=t.n(i),u=t("FaU1"),s=t("V39N"),d=6,f=7},h62Y:function(e,n,t){"use strict";function o(e){function n(){r.a.bindFramebuffer(d,e.framebuffer,u),d.viewport(0,0,f.width,f.height),y.boundingBoxUpdated&&v?(l.dx=-(e.bbox.minX-v.minX)/(e.bbox.maxX-e.bbox.minX),l.dy=-(e.bbox.minY-v.minY)/(e.bbox.maxY-e.bbox.minY),l.scale=(e.bbox.maxX-e.bbox.minX)/(v.maxX-v.minX),c(s,e.fadeOpacity,l)):c(s,e.fadeOpacity,a)}function t(){r.a.bindFramebuffer(d,null),i(),d.enable(d.BLEND),d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA),d.clearColor(p.r,p.g,p.b,p.a),d.clear(d.COLOR_BUFFER_BIT),c(u,1,a),d.disable(d.BLEND);var e=s;s=u,u=e,y.boundingBoxUpdated=!1,window.audioTexture&&c(window.audioTexture,1,a)}function o(){var e=f.width,n=f.height,t=new Uint8Array(e*n*4);u&&d.deleteTexture(u),s&&d.deleteTexture(s),u=r.a.createTexture(d,d.NEAREST,t,e,n),s=r.a.createTexture(d,d.NEAREST,t,e,n)}function i(){if(!v)return void(v={minX:e.bbox.minX,minY:e.bbox.minY,maxX:e.bbox.maxX,maxY:e.bbox.maxY});v.minX=e.bbox.minX,v.minY=e.bbox.minY,v.maxX=e.bbox.maxX,v.maxY=e.bbox.maxY}function c(n,t,o){var a=x;d.useProgram(a.program),r.a.bindAttribute(d,e.quadBuffer,a.a_pos,2),r.a.bindTexture(d,n,e.screenTextureUnit),d.uniform1i(a.u_screen,e.screenTextureUnit),d.uniform1f(a.u_opacity_border,.02),d.uniform1f(a.u_opacity,t),d.uniform3f(a.u_transform,o.dx,o.dy,o.scale),d.drawArrays(d.TRIANGLES,0,6)}var u,s,d=e.gl,f=e.canvasRect,l={dx:0,dy:0,scale:1},v=null,p={r:19/255,g:41/255,b:79/255,a:1};o();var x=r.a.createProgram(d,"// screen program\nprecision highp float;\n\nattribute vec2 a_pos;\nvarying vec2 v_tex_pos;\nuniform vec3 u_transform;\n\nvoid main() {\n    v_tex_pos = a_pos;\n    vec2 pos = a_pos;\n\n    // This transformation tries to move texture (raster) to the approximate position\n    // of particles on the current frame. This is needed to avoid rendering artifacts\n    // during pan/zoom: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n\n    // PS: I must admit, I wrote this formula through sweat and tears, and\n    // I still have no idea why I don't need to apply (pos.y - 0.5) to Y coordinate.\n    // Is it because I use aspect ratio for bounding box?\n    pos.x = (pos.x - 0.5) / u_transform.z - u_transform.x + 0.5 * u_transform.z;\n    pos.y = pos.y / u_transform.z + u_transform.y;\n\n    pos = 1.0 - 2.0 * pos;\n    gl_Position = vec4(pos, 0, 1);\n}","precision highp float;\nuniform sampler2D u_screen;\nuniform float u_opacity;\nuniform float u_opacity_border;\n\nvarying vec2 v_tex_pos;\n\nvoid main() {\n  vec2 p = 1.0 - v_tex_pos;\n  vec4 color = texture2D(u_screen, p);\n\n  // For some reason particles near border leave trace when we translate the texture\n  // This is my dirty hack to fix it: https://computergraphics.stackexchange.com/questions/5754/fading-particles-and-transition\n  if (p.x < u_opacity_border || p.x > 1. - u_opacity_border || p.y < u_opacity_border || p.y > 1. - u_opacity_border) {\n    gl_FragColor = vec4(0.);\n  } else {\n    // opacity fade out even with a value close to 0.0\n    gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);\n  }\n}"),y={fadeOutLastFrame:n,renderCurrentScreen:t,updateScreenTextures:o,boundingBoxUpdated:!1};return y}n.a=o;var r=t("Ddjs"),a={dx:0,dy:0,scale:1}},i69e:function(e,n,t){"use strict";var o=t("Zx67"),r=t.n(o),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),v=t("4KA4"),p=function(e){function n(){return i()(this,n),d()(this,(n.__proto__||r()(n)).call(this))}return l()(n,e),u()(n,[{key:"getDefines",value:function(){return"\nuniform float u_h;\n"}},{key:"getFunctions",value:function(){return"\nvec2 rk4(const vec2 point) {\n  vec2 k1 = get_velocity( point );\n  vec2 k2 = get_velocity( point + k1 * u_h * 0.5);\n  vec2 k3 = get_velocity( point + k2 * u_h * 0.5);\n  vec2 k4 = get_velocity( point + k3 * u_h);\n\n  return k1 * u_h / 6. + k2 * u_h/3. + k3 * u_h/3. + k4 * u_h/6.;\n}"}},{key:"getMainBody",value:function(){return"\n  vec2 velocity = rk4(pos);\n"}}]),n}(v.a);n.a=p},iw7m:function(e,n,t){"use strict";function o(e){if(!e)return a.a.reject("Missing link");var n=e.trim();if(!n)return a.a.reject("Missing link");var o=s.get(n);return o?a.a.resolve(o):t.i(u.a)(e).then(function(n){return s.set(e,n),n})}n.a=o;var r=t("//Fk"),a=t.n(r),i=t("ifoU"),c=t.n(i),u=t("C8nW"),s=new c.a},n67P:function(e,n,t){"use strict";function o(){function e(e,n){var t=r.get(e);t&&t.dispose(),r.set(e,n)}function n(e){o=e,r.forEach(t)}function t(e,n){e.updateBinding(o,n)}var o,r=new a.a;return{updateBindings:n,bindInput:e}}n.a=o;var r=t("ifoU"),a=t.n(r)},p0IO:function(e,n,t){"use strict";function o(e,n){var t=0,o=0,r=1;return{applyTransform:function(e){var a=e.x,i=e.y;0==r-e.scale&&Math.abs(a-t)<2.1&&Math.abs(i-o)<2.1||(t=a,o=i,r=e.scale,n(e))},getOwner:function(){return e}}}n.a=o},p2DF:function(e,n,t){"use strict";t("rvz5"),t("Ddjs")},p9aJ:function(e,n,t){"use strict";function o(e){function n(){window.removeEventListener("mousemove",r,!0),window.removeEventListener("mousedown",a,!0),window.removeEventListener("touchstart",t,!0),window.removeEventListener("touchmove",o,!0)}function t(e){var n=e.touches[0];n&&(c(n.clientX,n.clientY),i(n.clientX,n.clientY))}function o(e){var n=e.touches[0];n&&i(n.clientX,n.clientY)}function r(e){i(e.clientX,e.clientY)}function a(e){c(e.clientX,e.clientY)}function i(n,t){e.cursor.hoverX=u(n),e.cursor.hoverY=s(t)}function c(n,t){e.cursor.clickX=u(n),e.cursor.clickY=s(t)}function u(e){var n=(e-d.left)/d.width;return(f.maxX-f.minX)*n+f.minX}function s(e){var n=1-(e-d.top)/d.height;return(f.minY-f.maxY)*n+f.maxY}var d=e.canvasRect,f=e.bbox;return window.addEventListener("mousemove",r,!0),window.addEventListener("mousedown",a,!0),window.addEventListener("touchstart",t,!0),window.addEventListener("touchmove",o,!0),{dispose:n}}n.a=o},pKWO:function(e,n,t){"use strict";function o(e){function n(){m&&m.unload();var n=new a.a(e),t=n.getVertexShader(b);m=r.a.createProgram(h,t,n.getFragmentShader())}function o(){b&&(e.frame+=1,e.frameSeed=Math.random(),g&&g.updateTextures(),_.updateParticlesPositions())}function d(){n()}function f(t){e.frame=0,b=t,_.updateCode(t),n()}function l(){p=e.particleStateResolution,y=p*p;for(var n=new Float32Array(y),o=new Uint8Array(4*y),a=new Uint8Array(4*y),i=e.bbox.minX,u=e.bbox.minY,s=e.bbox.maxX-i,d=e.bbox.maxY-u,f=0;f<y;f++)t.i(c.a)(Math.random()*s+i,o,4*f),t.i(c.a)(Math.random()*d+u,a,4*f),n[f]=f;x&&h.deleteBuffer(x),x=r.a.createBuffer(h,n),_.updateParticlesCount(o,a)}function v(){if(b){var n=m;h.useProgram(n.program),r.a.bindAttribute(h,x,n.a_index,1),_.prepareToDraw(n),e.inputs.updateBindings(n),h.uniform1f(n.u_h,e.integrationTimeStep),h.uniform1f(n.frame,e.frame),h.uniform1f(n.u_particles_res,p);var t=e.bbox;h.uniform2f(n.u_min,t.minX,t.minY),h.uniform2f(n.u_max,t.maxX,t.maxY);var o=e.cursor;h.uniform4f(n.cursor,o.clickX,o.clickY,o.hoverX,o.hoverY),h.drawArrays(h.POINTS,0,y)}}var p,x,y,g,m,h=e.gl,b="",_=t.i(i.a)(e);return function(){n(),u.a.isAudioEnabled&&(g&&g.dispose(),g=t.i(s.a)(e))}(),{updateParticlesCount:l,updateParticlesPositions:o,drawParticles:v,updateCode:f,updateColorMode:d}}n.a=o;var r=t("Ddjs"),a=t("aZPT"),i=t("3xg8"),c=t("FaU1"),u=t("rvz5"),s=t("94y8")},pXNl:function(e,n,t){"use strict";function o(e,n,t){function o(n){c.forEach(function(t){e.uniform1i(n["u_particles_"+t.name],t.index)})}function a(){c.forEach(function(n){return e.deleteTexture(n.texture)})}function i(e,n){c.forEach(function(t){r.a.bindTexture(e,t.texture,t.index),e.uniform1i(n["u_particles_"+t.name],t.index)})}var c=n.map(function(n,o){return{texture:r.a.createTexture(e,e.NEAREST,n.particleState,t,t),index:o,name:n.name}});return{dispose:a,bindTextures:i,assignProgramUniforms:o,length:n.length,textures:c,get:function(e){return c[e]}}}n.a=o;var r=t("Ddjs")},rvz5:function(e,n,t){"use strict";var o=t("NEgR"),r={isAudioEnabled:!1,vectorLinesEnabled:!1,FREE_TEXTURE_UNIT:4,showBindings:o.a.getQS().get("showBindings")||!1};n.a=r},sbZs:function(e,n,t){"use strict";function o(e){h=e;var n=x.a.getQS().get("auto");if(n){var t=parseInt(n,10);return p()(t)?void console.error("malformed auto param; not a number"):(t<=500&&(console.warn("auto param is too small; defaulting to 30000"),t=3e4),g=t,b=setTimeout(a,g),r)}}function r(){clearTimeout(b),b=0}function a(){m&&m.length||(m=c(y.a));var e=m.shift();h.vectorFieldEditorState.setCode(e.code),u(e.colorMode)&&h.setColorMode(e.colorMode),u(e.timeStep)&&h.setIntegrationTimeStep(e.timeStep),u(e.fadeOut)&&h.setFadeOutSpeed(e.fadeOut),u(e.dropProbability)&&h.setDropProbability(e.dropProbability),u(e.particleCount)&&h.setParticlesCount(e.particleCount);var n=x.a.makeBBox(e.cx,e.cy,e.w,e.h);n&&i(n),b=setTimeout(a,g)}function i(e){var n=l()({},h.getBoundingBox()),t=Date.now(),o=e.minX-n.minX,r=e.maxX-n.maxX,a=e.minY-n.minY,i=e.maxY-n.maxY;!function c(){var u=(Date.now()-t)/3e3;if(u>=1)return void h.applyBoundingBox(e);requestAnimationFrame(c);var s={minX:n.minX+o*u,maxX:n.maxX+r*u,minY:n.minY+a*u,maxY:n.maxY+i*u};h.applyBoundingBox(s)}()}function c(e){for(var n=e.slice(),t=0;t<n.length;t++){var o=Math.floor(Math.random()*n.length),r=n[t];n[t]=n[o],n[o]=r}return n}function u(e){return d()(e)}n.a=o;var s=t("AMV0"),d=t.n(s),f=t("woOf"),l=t.n(f),v=t("MICi"),p=t.n(v),x=t("NEgR"),y=t("7QEO"),g=void 0,m=void 0,h=void 0,b=void 0},svlg:function(e,n,t){"use strict";function o(e){if(!e)return new i.a(function(e){return e(s)});var n=r(e);return n.pending.length>0?i.a.all(n.pending).then(function(){return n}).catch(function(e){return{error:{error:e}}}):new i.a(function(e){return e(n)})}function r(e){function n(){return i.join("\n")}function o(e){if(0===e.indexOf(u)){var n=e.substr(u.length),o=s;r.push(t.i(c.a)(n).then(function(e){i[o]=e}))}}var r=[],a=e.split("\n"),i=[],s=0;return a.forEach(function(e,n){s=n,e&&"#"===e[0]?(i.push(""),o(e)):i.push(e)}),{getCode:n,pending:r}}n.a=o;var a=t("//Fk"),i=t.n(a),c=t("iw7m"),u="#include ",s={code:""}},vhRe:function(e,n,t){"use strict";var o=t("Zx67"),r=t.n(o),a=t("Zrlr"),i=t.n(a),c=t("wxAW"),u=t.n(c),s=t("zwoO"),d=t.n(s),f=t("Pf15"),l=t.n(f),v=t("4KA4"),p=function(e){function n(e){i()(this,n);var t=d()(this,(n.__proto__||r()(n)).call(this));return t.decode=e&&e.decode,t.srcPosName=e&&e.posName||"pos",t}return l()(n,e),u()(n,[{key:"getDefines",value:function(){if(this.decode)return"\n  uniform vec2 u_min;\n  uniform vec2 u_max;\n"}},{key:"getMainBody",value:function(){return this.decode?"\n  // move particle position according to current transform\n  vec2 du = (u_max - u_min);\n  pos.x = "+this.srcPosName+".x * du.x + u_min.x;\n  pos.y = "+this.srcPosName+".y * du.y + u_min.y;\n":"\n  pos.x = ("+this.srcPosName+".x - u_min.x)/du.x;\n  pos.y = ("+this.srcPosName+".y - u_min.y)/du.y;\n"}}]),n}(v.a);n.a=p}},["YJWA"]);
//# sourceMappingURL=app.1482fb1e4415f8a02bb9.js.map